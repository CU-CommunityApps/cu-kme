<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">

	<!-- iPad/iPhone specific css below, add after your main css >
	<link rel="stylesheet" media="only screen and (max-device-width: 1024px)" href="ipad.css" type="text/css" />		
	<link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="iphone.css" type="text/css" />		
	-->
        
	<!-- If your application is targeting iOS BEFORE 4.0 you MUST put json2.js from http://www.JSON.org/json2.js into your www directory and include it here -->
	<script type="text/javascript" charset="utf-8" src="phonegap-1.0.0.js"></script>       
    <script type="text/javascript" charset="utf-8" src="https://test.uisapp2.iu.edu/kme-unt/js/jquery-1.6.1.min.js"></script>       
    <script type="text/javascript" charset="utf-8" src="ajax-get.js"></script>
    <script type="text/javascript" charset="utf-8" src="ChildBrowser.js"></script>
    <script type="text/javascript" charset="utf-8">
	
        var root = this;
        
        function onBodyLoad() {		
            document.addEventListener("deviceready",onDeviceReady,false);
        }
	    
        function notificationCallback(data) {
            // We could call back to the server as a type of read receipt
        }
        
        function constructUserId() {
            return "nate"; //escape(device.platform) + "-" + escape(device.uuid);
        }
        
        function doNotifications(notifications) {
            $.each(notifications, function(index, notification) {                   
                   navigator.notification.alert(notification.message, notificationCallback, notification.title);
                   navigator.notification.vibrate(2000);
                   });
        }

        function doErrors(errors) {
            //alert(erros);
        }
        
        function checkNotifications() {
            //AjaxGet('http://129.79.44.155:9999/mdot/notifications', {'deviceId':constructUserId()}, doNotifications, doErrors);
            AjaxGet('notification.json', {'deviceId':constructUserId()}, doNotifications, doErrors);
        }
        
        function onDeviceReady() {
            var cb = ChildBrowser.install();
            if (cb != null) {
                window.plugins.childBrowser.showWebPage("https://test.uisapp2.iu.edu/kme-unt/home");
            }

            window.setInterval(function() { checkNotifications(); }, 10000);
        }
    
    </script>
  </head>
  <body onload="onBodyLoad()">
  </body>
</html>
